!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.AMO=e()}(this,function(){"use strict";function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;function e(t,e){return t(e={exports:{}},e.exports),e.exports}var n=e(function(t,e){t.exports=function(){var t=function(){function t(t){return function(e){return t.call(e,e.data)}}function e(t){return function(e,n){return t.call(e,n,e.data),n}}return function(n){if(n){var o,r,i,s={};for(var c in n)o=n[c],i=typeof o,"expression"!==o.type?"string"!==i&&(r=s[c]={type:"expression"},"function"===i?r.get=t(o):(o.get&&(r.get=t(o.get)),o.set&&(r.set=e(o.set)))):s[c]=o;return s}}}(),e=function(){this.t=null,this.tasks=[]};e.prototype.add=function(t){this.tasks.push(t)},e.prototype.run=function(t){var e=this;this.t&&clearTimeout(this.t),this.t=setTimeout(function(){t(),e.tasks.forEach(function(t,n){"function"==typeof t&&(t(),e.tasks[n]=null)}),e.tasks.length=0},0)};var n=function(t){var n=this;void 0===t&&(t={});var o=t.modules;void 0===o&&(o={});var r=t.actions;void 0===r&&(r={});var i,s,c=t.plugins;void 0===c&&(c=[]),Object.assign(this,{_state:{},_reducers:{},_modules:o,_getters:{},_actions:r,_plugins:c,_subscribers:[],_viewUpdateSubscribers:[],scheduler:new e}),Object.keys(o).forEach(function(t){return n.registerModule(t,o[t])}),i=this,(s=window&&window.__REO_DEVTOOLS_HOOK__)&&(i._devtools=s,s.emit("reo:init",i),s.on("reo:travel-to-state",function(t){i.replaceState(t)}),s.on("reo:silent-travel-to-state",function(t){i.replaceState(t,{silent:!0})}),i.subscribe(function(t,e){s.emit("reo:reducer",t,e)}),i.subscribeViewUpdate(function(){s.emit("reo:view-updated")})),c.forEach(function(t){return n.use(t)})};function o(t){return void 0!==t.type}n.prototype.use=function(t){t(this)},n.prototype.replaceState=function(t,e){void 0===e&&(e={});var n=e.silent;void 0===n&&(n=!1),this._state=t,n||this.syncView()},n.prototype.getState=function(){return this._state},n.prototype.getGetters=function(){return this._getters},n.prototype.nextTick=function(t){this.scheduler.add(t)},n.prototype.dispatch=function(t,e){var n,r=this;if("string"==typeof t)n={type:t,payload:e};else{if(!o(t))return console.error("invalid dispatch params",arguments);n=t}var i=this._actions[n.type];return"function"!=typeof i?console.error("action",n.type,"not found"):i({getState:this.getState.bind(this),state:this.getState(),get:function(t){var e=r.getGetters(),n=e[t];if("function"==typeof n)return n(r.getState())},commit:this.commit.bind(this),dispatch:this.dispatch.bind(this),nextTick:this.nextTick.bind(this)},n.payload)},n.prototype.commit=function(t,e){var n,r=this;if("string"==typeof t)n={type:t,payload:e};else{if(!o(t))return console.error("invalid commit params",arguments);n=t}var i=this._reducers[n.type];if("function"==typeof i){var s=this.getState(),c=void 0===i.key?s:s[i.key];i(c,n.payload),this._applySubscribers(n,s),this.scheduler.run(function(){return r.syncView()})}else console.error("reducer",n.type,"not found")},n.prototype.syncView=function(){this._host.forEach(function(t){return t.$update()}),this._viewUpdateSubscribers.forEach(function(t){return t()})},n.prototype.host=function(t){this._host||(this._host=[]),this._host.push(t)},n.prototype.subscribe=function(t){"function"==typeof t&&this._subscribers.push(t)},n.prototype.subscribeViewUpdate=function(t){"function"==typeof t&&this._viewUpdateSubscribers.push(t)},n.prototype.registerModule=function(t,e){if(void 0===t&&(t=""),void 0===e&&(e={}),!t)return console.error("Please provide a name when register module");this._state[t]=e.state||{};var n=e.reducers||{};for(var o in n)n[o].key=t;n=function(t,e){var n={};return Object.keys(t).forEach(function(o){n[e+"/"+o]=t[o]}),n}(n,t),Object.assign(this._reducers,n)},n.prototype.registerActions=function(t){void 0===t&&(t={}),Object.assign(this._actions,t)},n.prototype.registerGetters=function(t){void 0===t&&(t={}),Object.assign(this._getters,t)},n.prototype._applySubscribers=function(t,e){for(var n=this._subscribers,o=0,r=n.length;o<r;o++){var i=n[o];i(t,e)}};var r=function(e){var o;e.implement({events:{$config:function(){var e;if((e=this.store)&&e instanceof n&&(o&&(console.warn("store already exists"),console.warn("old store:",o),console.warn("new store:",this.store),console.warn("new store will be used")),(o=this.store).host(this),delete this.store),!o)return console.warn("store not found");this.$store=o,this.commit=o.commit.bind(o),this.dispatch=o.dispatch.bind(o),this.nextTick=o.nextTick.bind(o);var r=o.getGetters(),i=this.getters;void 0===i&&(i={}),Object.keys(i).forEach(function(t){var e=i[t];"string"==typeof e&&(e=r[e]),"function"==typeof e&&(i[t]=function(){return e(o.getState())})}),function(e,n){Object.assign(e.computed||{},t(n))}(this,i)}}})};return r.Store=n,r}()}),o=(e(function(t,e){t.exports=function(){function t(t,e){return n="0",o=e-t.toString().length,new Array(o+1).join(n)+t;var n,o}return function(e){void 0===e&&(e={});var n=e.collapsed;void 0===n&&(n=!0);var o=e.transformer;void 0===o&&(o=function(t){return t});var r=e.mutationTransformer;return void 0===r&&(r=function(t){return t}),function(e){var i=JSON.parse(JSON.stringify(e.getState()));e.subscribe(function(e,s){var c=JSON.parse(JSON.stringify(s)),u=new Date,a=" @ "+t(u.getHours(),2)+":"+t(u.getMinutes(),2)+":"+t(u.getSeconds(),2)+"."+t(u.getMilliseconds(),3),f="commit "+e.type+a;n?console.groupCollapsed(f):console.group(f),console.log("%c prev state","color: #9E9E9E; font-weight: bold",o(i)),console.log("%c commit","color: #03A9F4; font-weight: bold",r(e)),console.log("%c next state","color: #4CAF50; font-weight: bold",o(c)),console.groupEnd(f),i=c})}}}()}),function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var t=new n.Store;this._store=t}var o,r,i;return o=e,(r=[{key:"getStore",value:function(){return this._store}},{key:"use",value:function(t){t.use(n)}},{key:"model",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.name;if(!e)return console.error("Please provide name for model",t);this.getStore().registerModule(e,t)}},{key:"getters",value:function(t){this.getStore().registerGetters(t)}},{key:"actions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.getStore().registerActions(t)}},{key:"start",value:function(t,e){return new t({store:this.getStore()}).$inject(document.querySelector(e))}}])&&t(o.prototype,r),i&&t(o,i),e}());return function(){return new o}});
//# sourceMappingURL=amo.min.js.map
